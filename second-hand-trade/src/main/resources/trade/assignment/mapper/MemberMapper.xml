<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="trade.assignment.repository.MemberRepository">
	
	    <!--프라이머리 키 = id 라고 지정해준다.  -->
    <resultMap type="member" id="memberMap">
         <id column="MNO" property="no"/>
         <result column="NAME" property="name"/>
         <result column="EMAIL" property="email"/>
         <result column="PRI_LEVEL" property="prilevel"/>
         <result column="PROFILEPHOTO" property="memberPicture"/>
         <result column="PWD" property="password"/>
       </resultMap>
       
  <insert id="insert" parameterType="Member">
    insert into tbl_user(EMAIL,NAME,PWD) 
    values(#{email},#{name},password(#{password}))
  </insert>
 
 <select id="findByEmailAndPassword"
  parameterType="map"
  resultMap="memberMap">
    select MNO,EMAIL, NAME
    from tbl_user
    where EMAIL=#{email} and PWD =password(#{password})
 </select>
 
  <select id="authenticate"   
	  parameterType="map"
	  resultMap="memberMap">
        SELECT
            MNO,
            EMAIL,
            PRILEVEL
        FROM tbl_user
        WHERE EMAIL = #{email}
    </select>
    
    <update id="createAuthKey">
        UPDATE tbl_user
        SET AUTHKEY = #{memberAuthKey}
        WHERE EMAIL = #{email}
    </update>
    
        <insert id="naverInsertUser">
        INSERT INTO tbl_user (EMAIL, SNSID, NAME)
        VALUES (#email}, #{snsID}, #{name})
    </insert>

    <select id="naverReadUser" resultType="MemberVO">
        SELECT
            MNO,
            name    name,
            EMAIL   email,
            PROFILEPHOTO 
        FROM tbl_user
        WHERE SNSID = #{snsID}
    </select>
    

</mapper>



